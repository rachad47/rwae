<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>BilliardBot</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/unicons.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">

    <!-- MAIN STYLE -->
    <link rel="stylesheet" href="css/tooplate-style.css">
    <link rel="icon" type="image/x-icon" href="images/project/BilliardBot/logoBB.ico">
    <link href="themes/prism.css" rel="stylesheet" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <!--

Tooplate 2115 Marvel

https://www.tooplate.com/view/2115-marvel

-->
</head>


<body>


    <!-- MENU -->
    <nav class="navbar navbar-expand-sm navbar-light">
        <div class="container">
            <a class="navbar-brand" href="index.html"><i class='uil uil-user'></i> Main page </a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                <span class="navbar-toggler-icon"></span>
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a href="index.html#about" class="nav-link"><span data-hover="About">About</span></a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#BigProjct" class="nav-link"><span data-hover="Projects">Projects</span></a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#resume" class="nav-link"><span data-hover="Resume">Resume</span></a>
                    </li>
                    <li class="nav-item">
                        <a href="index.html#contact" class="nav-link"><span data-hover="Contact">Contact</span></a>
                    </li>
                </ul>

                <ul class="navbar-nav ml-lg-auto">
                    <div class="ml-lg-4">
                        <div class="color-mode d-lg-flex justify-content-center align-items-center">
                            <i class="color-mode-icon"></i>
                            Color mode
                        </div>
                    </div>
                </ul>
            </div>
        </div>
    </nav>
    <hr class="rounded">
    <section class="about full-screen d-lg-flex justify-content-center align-items-center" id="lol">
        <!-- <img src="images/project/LTbrd.png" style="height:600px ;" alt="" class="img-fluid" id="lool"> -->
        <img src="images/project/BilliardBot/Blogob.jpg" style="max-height:560px ;" alt="" class="img-fluid" id="lool">
        <!-- <img src="images/project/gif1.gif" alt="" class="img-fluid" id="lool"> -->
    </section>
    <!-- ABOUT -->
    <section class="contact py-3" id="contact">

        <div style="text-align: center;" class="container ">
            <h1>Billiard Bot</h1>

            <div class="row align-items-center">
                <div class="col-sm-12 col-md-7 col-lg-7">
                    <h3 style="text-align: center;">Idea</h3>
                    <br>
                    <li style="text-align: left;">
                        I wanted to work on a project that would combine multiple engineering disciplines. I also wanted to
                        keep it and to improve the software and the AI and decision making overtime.
                    </li>

                    <br>
                    <!-- <H6>Software for the win!</H6> -->
                </div>
                <div class="col-sm-12 col-md-5 col-lg-5">
                    <img src="images/project/BilliardBot/logo.webp" alt="Paris" style="height:280px" id="programmingLA">
                    <!-- <video src="images/project/BilliardBot/demo1s.mp4" alt="" style="width: 100%;
                    height: auto;" id="programmingLA" controls>
                    </video> -->
                </div>
            </div>

            
            

            <hr class="rounded">
<br>

            <h2 style="text-align: center;">Concept</h2>
            <div class="row align-items-center">
                <div class="col-sm-12 col-md-6 col-lg-6">
                
                    <li style="text-align: left;">The camera is placed on top and we have computer vision with openCV
                        responsible for ball detections measurements and path decision</li>
                    <li style="text-align: left;">After Python sends a command to ESP32 through WIFI to move the robot
                        to specefic coordinates</li>
                    <li style="text-align: left;">Once arrived to the disgnated position and orientation we charge the
                        capacitors (200V) and disscharge the solnoid with them resulting in striking the ball</li>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/preview.jpg.png" alt="" style="width:80%" id="programingLA">
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <img src="images/project/BilliardBot/over1.png" alt="" style="width:100%" id="programmingLA">
                </div>
            </div>

            <div class="row align-items-center">
                
                
                <div class="col-sm-12 col-md-7 col-lg-8">
                  <h4>Highlights</h4>
                  <br>
                    <p>Work is still in progress, I'll keep updating the page as I move forward but here are some highlights</p>

                </div>

                <div class="col-sm-12 col-md-5 col-lg-4">
                    <img src="images/project/BilliardBot/Work_In_Progress.png" alt="" style="width:100%" id="programmingLA">
                </div>
            </div>

            
            <div class="row align-items-center">
                
                
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/troubleshooting.jpg" alt="" style="width:100%" id="programmingLA">
                    <p>Circuit troublshouting</p>

                </div>

                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/UI.png" alt="" style="width:100%" id="programmingLA">
                    <p>User Interface</p>
                </div>
            </div>


            <div class="row align-items-center">
                
                
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/strike.gif" alt="" style="width:100%" id="programmingLA">
                    <p>Puncher test</p>

                </div>

                <div class="col-sm-12 col-md-6 col-lg-6">
                    <!-- <img src="images/project/X95.jpg" alt="Paris" style="height:350px" id="programmingLA"> -->
                    <video autoplay src="images/project/BilliardBot/demo1s.mp4" alt="" style="width: 100%;
                    height: auto;" id="programmingLA" controls>
                    </video>
                    <p>Computer vision + mouvement</p>
                </div>
            </div>


            <hr class="rounded">

            <h2>Mechanical</h2>

            <br>

            <div class="row">
                <div class="col-12 col-sm-12 col-md-6 col-lg-7">
                    <h4>omniwheels</h4>

                    <p>The omnidirectional wheel, as the name suggests, can move in any direction, at any angle, and in
                        any direction. Therefore, compared to the traditional
                        differential drive method, the omnidirectional wheel can complete the rotation while
                        translating, <a href="https://youtu.be/OIdMkZyhx7E?si=dfeYYCNPFXWvryhR&t=43">more info</a></p>
                    <p>We also decided after reading some papers comparing 3 based / 4 wheel based structres we decided
                        on 3 wheels mainly due to costs</p>

                </div>

                <div class="col-12 col-sm-12 col-md-6 col-lg-5">
                    <img src="images/project/BilliardBot/omniwheel.jpg" alt="" style="width: 70%;height: auto;"
                        id="programmingLA">
                </div>
            </div>
            <br>



            <h4> Structure</h4>


            <div class="row">
                <div class="row align-items-center">
                    <div class="col-12 col-sm-4 col-md-4 col-lg-4 align-self-center">

                        <img src="images/project/BilliardBot/solidwork.jpg.png" alt="" style="width: 100%;height: auto;"
                            id="programmingLA">
                        <p> <a
                                href="https://cad.onshape.com/documents/23793d84011317cf4a6b9b74/w/362c07afd509d5f44f6e3bc9/e/1b476d1a2f6541f4adf1682c">3D
                                model</a> </p>
                    </div>

                    <div class="col-12 col-sm-4 col-md-4 col-lg-4 align-self-center">
                        <!-- <img src="images/project/coilgun/11.png" alt="Paris" style="width: 100%;height: auto;"
                            id="programmingLA"> -->
                        <img src="images/project/BilliardBot/LaserC.jpg" alt="" style="width: 100%;height: auto;"
                            id="programmingLA">
                        <p>Laser cut</p>
                    </div>

                    <div class="col-12 col-sm-4 col-md-4 col-lg-4 align-self-center">
                        <img src="images/project/BilliardBot/firstL.jpg" alt="" style="width: 100%;height: auto;"
                            id="programmingLA">
                        <p>First look.</p>

                    </div>

                </div>
            </div>




            <hr class="rounded">

            <h2>Electrical</h2>
            <br>

            <div class="row align-items-center">

                <div class="col-12 col-sm-12 col-md-12 col-lg-6">
                    <img src="images/project/BilliardBot/nema17+CNCshield.png" alt="" style="width:100%"
                        id="programmingLA">
                </div>

                <div class="col-12 col-sm-12 col-md-12 col-lg-6">
                    <h4>motors</h4>
                    <p>We chose stepper motors over other types for their precision, prioritizing accuracy over speed or
                        torque. Despite the manual cable connection required due to our use of
                        an ESP32 instead of an Arduino Uno, the CNC shield facilitated wiring and enabled microstepping
                        (increasing the resolution from 200 to 1600 steps per revolution),
                        enhancing the robot's precision. </p>
                </div>

            </div>

            <br>

            <div class="row">

                <div class="col-12 col-sm-12 col-md-12 col-lg-7 align-self-center">
                    <h4>Ball puncher</h4>
                    <br>
                    <p>Essentially, we utilize a voltage booster to elevate the voltage from 14V to 200V for charging
                        the capacitors, and subsequently discharge the stored energy, leading to
                        the impact on the ball.
                    </p>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-5 align-self-center">
                    <video src="images/project/BilliardBot/1stStrike.mp4" alt="" style="width: 100%;height: auto;"
                        id="rogrammingLA" controls>
                    </video>
                </div>

            </div>

            <br>

            <div class="row align-items-center">

                <div class="col-12 col-sm-12 col-md-4 col-lg-4">
                    <img src="images/project/BilliardBot/booster.png" alt="" style="width:75%" id="programmingLA">
                    <p>12V -> 45~385V <a
                            href="https://www.amazon.com/Regulator-Converter-%C2%B145V-390V-Capacitor-Charging/dp/B07SM89NJ4/ref=psdc_10967761_t3_B07T6L61D9">
                            votage booster</a> </p>
                </div>


                <div class="col-12 col-sm-12 col-md-4 col-lg-4">
                    <img src="images/project/BilliardBot/cap.png" alt="" style="width:75%" id="programmingLA">
                    <p>2*1000uF 200V capacitors</p>
                </div>

                <div class="col-12 col-sm-12 col-md-4 col-lg-4">
                    <img src="images/project/BilliardBot/solenoid.png" alt="" style="width:75%" id="programmingLA">
                    <p>Solenoid</p>
                </div>

            </div>
            <br>


            <div class="row align-items-center">

                <div class="col-12 col-sm-12 col-md-12 col-lg-5">
                    <img src="images/project/BilliardBot/graphcap.png" alt="" style="width:90%" id="programmingLA">
                </div>

                <div class="col-12 col-sm-12 col-md-12 col-lg-7">
                    <h4>Customizing the force</h4>
                    <br>
                    <p>
                        Increasing the voltage equates to increasing the power output. The concept is to create three
                        distinct levels of power for the shots: a weak shot,
                        a medium shot, and a strong shot. This is achieved by timing the charging process and
                        interrupting the current flow to the capacitors when they reach
                        a certain percentage of charge.</p>
                </div>

            </div>
            <br>

            <h4>Power distribution</h4>
            <p>The full diagram includes components such as optocouplers, thyristors explained in detail in my <a
                    href="CoilGun.html">CoilGun project</a> a 4s LiPo battery, a buck converter
                for voltage stability, and a 7-segment voltage reader. </p>
            <img src="images/project/BilliardBot/stevenDiagram.png" alt="" style="width:100%" id="programmingLA">
            <br>
            <hr class="dotted">
            <h3>Full circuit and integration</h3>
            <img src="images/project/BilliardBot/circuitF.png" alt="" style="width:80%" id="programingLA">
            <p>I intend to make a more comprehensive circuit with a professional software later on</p>


            <div class="row">

                <div class="col-12 col-sm-12 col-md-12 col-lg-6 align-self-center">
                    <img src="images/project/BilliardBot/espCir1.jpg" alt="" style="width:100%" id="programmingLA">
                    <p>NPN transistor + optocouplers</p>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-6 align-self-center">
                    <video src="images/project/BilliardBot/puncher.mp4" alt="" style="width: 100%;
                    height: auto;" id="programmingLA" controls>
                    </video>
                    <p>Integration test with high voltage circuit</p>
                </div>

            </div>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-7 col-lg-7">
                    <h4 style="text-align: center;">Circuit & PCB</h4>
                    <li>Still working on the integration and testing to make sure our prototype works correclty</li>
                    <li>Eventually we would do the circuit in PCB</li>

                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-5 col-lg-5">
                    <img src="images/project/BilliardBot/Work_In_Progress.png" alt="" style="width: 100%;height: auto;"
                        id="programmingLA">

                </div>

            </div>

            <hr class="rounded">

            <h2>Software</h2>
            <br>
            <p>You can find the source code here: <a href="https://github.com/rachad47/BilliardBot">GitHub</a></p>
            <br>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-7 col-lg-8">
                    <h3 style="text-align: center;">Overview</h3>
                    <p>camera -> AI -> decision making -> motors -> solenoid -> ball -> pocket </p>
                    <p> The camera is placed on top and we have computer vision with openCV responsible for ball
                        detections
                        measurements and path decision
                        After Python sends a command to ESP32 through WIFI to move the robot to specefic coordinates
                        Once arrived to the disgnated position and orientation we charge the capacitors (200V) and
                        disscharge
                        the solnoid with them resulting in striking the ball </p>

                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-5 col-lg-4">
                    <img src="images/project/BilliardBot/preview.jpg.png" alt="" style="width: 100%;height: auto;"
                        id="programmingLA">

                </div>

            </div>

            <div class="row">


                <div class="col-12 col-sm-12 col-md-12 col-lg-12">
                    <img src="images/project/BilliardBot/over2.png" alt="" style="width: 100%;height: auto;"
                        id="programmingLA">
                </div>


            </div>
            <br>

            <hr class="dotted">

            <h3>Computer vision</h3>

            <br>
            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-8 col-lg-9">
                    <h5 style="text-align: left;">HSV Model</h5>
                    <p>In computer vision HSV model is often used instead of the RGB in color detection since HSV we can
                        easily
                        select treshold for colors that would work with different lighting conditions (unlike RGB which
                        is hard
                        to vary the threshold ), so here is my project im using HSV further Im also creating maks such
                        as first
                        detect the table then only consider objects within that boundary </p>

                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-4 col-lg-3">
                    <img src="images/project/BilliardBot/hsv.jpeg" alt=""
                        style="max-height:300px ; width: 100%;height: auto;" id="programmingLA">
                </div>
            </div>


            <!-- <h5 style="text-align: left;">Robot detection & orientation</h5> -->

            <br>
            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">
                    <h5 style="text-align: left;">Robot detection</h5>
                    <!-- <img src="images/project/BilliardBot/sw1.png" alt=""
                        style="max-height:300px ; width: 100%;height: auto;" id="programminLA"> -->
                    <li>Detect the boundary table (yellow counter)</li>
                    <li>Detect the robot within the table (pink counter) </li>
                    <li>We can use <code>cv2.bitwise_and</code> for such maskings </li>
                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">
                    <h5 style="text-align: left;">Robot orientation</h5>
                    <!-- <img src="images/project/BilliardBot/sw1.png" alt=""
                        style="max-height:300px ; width: 100%;height: auto;" id="programminLA"> -->
                    <li>Considers the black spot as the center of the robot</li>
                    <li>The Y-axis to be from the black spot to the red spot</li>
                    <li>The X-axis to be 90* to the right of the Y-axis</li>
                </div>


            </div>

            <br>


            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: center;">Calculating distances</h5>
                    <li>At that point I simply used color detections to look for balls for a certain size</li>
                    <li>

                        In OpenCV, images are considered as pixel grids. To measure distances and angles, I use a 2D
                        distance formula and the cross product method, converting from pixels to centimeters based on
                        the ball's size. All
                        calculations are based on the robot being at the origin (0,0), with projections used to find X
                        and Y coordinates.
                    </li>

                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-6 col-lg-5">
                    <br>
                    <img src="images/project/BilliardBot/sw1.png" alt=""
                        style="max-height:300px ; width: 100%;height: auto;" id="programmingA">
                    <!-- <p>HERE PUT A VIDEO</p> -->
                </div>
            </div>

            <br>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: center;">detection & classification of balls</h5>
                    <p>We can only do much with computer vision even if we carefully tuned the paramters of
                        cv2.HoughCirle ML required to detect the ball, we also have to classify them into 4 categories:
                    </p>
                    <li>Cue ball: white one</li>
                    <li>black ball: 8 ball</li>
                    <li>solid balls: (our balls)</li>
                    <li>stripe balls: (opponent balls)</li>
                    <p>There is no need to get to detect the exact number or color of each ball our strategy is to
                        consider all solid balls as valid target and opponent balls as no go </p>

                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-6 col-lg-5">
                    <img src="images/project/BilliardBot/CircleH.png" alt=""
                        style="max-height:400px ; width: 100%;height: auto;" id="programmingLA">
                </div>
            </div>

            <br>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: center;">Strategy to hit the ball (still working on it)</h5>
                    <li><b>Strike position:</b> Provided we know the position of the cue ball, the target ball, and the
                        pocket, currently we
                        are
                        just calculating the distance from the center of the robot to the center of the ball (so it will
                        hit the ball with the robot structure instead of the solenoid). Eventually, we have to calculate
                        where the robot should go to strike the ball at the desired angle without colliding anything on
                        its
                        path.
                    </li>
                    <li><b>Error mitigation:</b> when dealing with big distances it is better to not send one big
                        signle command, instead we devide it into smaller steps and recalculate after each step</li>



                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-6 col-lg-5">
                    <img src="images/project/BilliardBot/strikestrat.png" alt=""
                        style="max-height:400px ; width: 100%;height: auto;" id="programmingLA">
                </div>
            </div>



            <br>
            <hr class="dotted">

            <h3>Physics calculations</h3>

            <br>


            <h4 style="text-align: left;">Robot mouvement</h4>
            <p style="text-align: left;">Assuming we have to move from A to B and we have both their coordinates, the
                motors don't understand
                distances or angle to we have to do some calculations to give the robot number of steps and speed of
                motor</p>
            <p style="text-align: left;">We have two option:</p>


            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">
                    <h5 style="text-align: center;">Polar coordinates</h5>
                    <p style="text-align: center;">First rotation then translation</p>
                    <video src="images/project/BilliardBot/polarD.mp4" alt="" style="width: 100%;
                    height: auto;" id="programmingL" controls>
                    </video>


                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">
                    <h5 style="text-align: center;">Carterian coordinates</h5>
                    <p style="text-align: center;">Vector addition to move from A->B without rotating</p>
                    <video src="images/project/BilliardBot/cartDemo.mp4" alt="" style="width: 100%;
                    height: auto;" id="programmingL" controls>
                    </video>
                </div>
            </div>
            <br>

            <div class="row align-items-center">

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: left;">Polar coordinates</h5>

                    <p>give the angle and the distance, we take raduis of the wheel.... to calculate the number of steps
                        required for rotation for the angle and same thing for translation
                    </p>
                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-5">

                    <img src="images/project/BilliardBot/polarD.png" alt=""
                        style="max-height:250px ; width: 100%;height: auto;" id="programmingLA">

                </div>
            </div>

            <br>
            <div class="row align-items-center">

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: left;">Carterian coordinates</h5>
                    <p>This one is harder as it involves vector addition, also required to move the wheels at diffrent
                        speeds to finish at the same time we will lose the vector addition calculation so dependind on
                        the distination if wheel X have 800 steps and wheel Y have 400 steps we will move wheel X at 2
                        of the speed of wheel Y in order to finish at the same time.
                    </p>
                    <p>A challenge arises when a small angle results in a disproportionate step count between wheels,
                        such as wheel Y at 200 steps and wheel Z at 3000 steps. To synchronize their finish times, Z
                        must rotate 15 times faster than Y. However, setting Y to an extremely slow speed leads to
                        vibrations, as stepper motors struggle with very slow speeds, even with microstepping.
                        Conversely, setting X to a moderate speed that avoids vibrations still poses a problem, as Z's
                        required 15x faster rotation could destabilize the robot and cause missteps. </p>


                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-6 col-lg-5">
                    <img src="images/project/BilliardBot/kinema.jpg" alt=""
                        style="max-height:700px ; width: 100%;height: auto;" id="programmingLA">

                </div>
            </div>
            <br>
            <h4 style="text-align: left;">Momentum Calculations</h4>
            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <p>Calculating the momentum to see what is the required angle position and force (*) of the solenoid
                        to
                        hit the ball at the desired speed and angle , {*} basically charging time of the capacitors, we
                        also the way we do the robot is that we make a linee btwn the the 2 balls (white and target)
                        then we make a perimiter around the white ball (robot raduis) and we make the intercection as
                        the point to go to then we approach the ball and orient the robot as needed
                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-5">

                    <img src="images/project/BilliardBot/momentum.png" alt=""
                        style="max-height:250px ;width: 100% ; height: auto;" id="programmingLA">

                </div>
            </div>

            <hr class="dotted">


            <h3>Firmware</h3>
            <br>
            <p style="text-align: left;">ESP32 is a microcontroller that has both WIFI capabilities, we use it to
                control the
                motors and the solenoid, so we have it connect to WIFI (same as computer) then we had multiple routes
            </p>
            <li style="text-align: left;"><code>/control</code>: Accepts 6 parameters to control the motors (StepsX,
                SpeedX, StepsY, SpeedY, StepsZ, SpeedZ)</li>
            <li style="text-align: left;"><code>/status</code>: Check wether the robot is done mooving or no (returns
                True/False)
            </li>
            <li style="text-align: left;"><code>/stop</code>: Stops the robot (emergency command)</li>
            <li style="text-align: left;"><code>/strike</code>: Charges capacitors and discharges into the solenoid,
                with an
                adjustable charging time for customizable force. </li>

            <br>


            <div class="row align-items-center">

                <div class="col-sm-12 col-md-12 col-lg-12">
                    <h5>/control</h5>
                    <p>The goal was being able to control individaully each wheel with a specefic revolution and speed
                        and have them turn at the same time, doing so direclty is challanging because of the way stepper
                        motor works with loops and <code>delay</code>, thankfully I found a library: <code>AccelStepper</code> that allows that without
                        manually coding the <code>millis</code> and non-blocking functions</p>
                </div>


            </div>


            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">
                    <div id="code-container">
                        <pre><code class="language-js">
                            //ESP-32 CODE

//setting up the server route
server.on("/control", HTTP_GET, [](AsyncWebServerRequest *request){
    String stepsX, speedX, stepsY, speedY, stepsZ, speedZ;

    if (request->hasParam("stepsX") && request->hasParam("speedX") &&
        request->hasParam("stepsY") && request->hasParam("speedY") &&
        request->hasParam("stepsZ") && request->hasParam("speedZ")) {

        stepsX = request->getParam("stepsX")->value();
        speedX = request->getParam("speedX")->value();
        stepsY = request->getParam("stepsY")->value();
        speedY = request->getParam("speedY")->value();
        stepsZ = request->getParam("stepsZ")->value();
        speedZ = request->getParam("speedZ")->value();

        controlSteppers(stepsX.toInt(), speedX.toFloat(), stepsY.toInt(), speedY.toFloat(), stepsZ.toInt(), speedZ.toFloat());
        request->send(200, "text/plain", "Motors commanded successfully");
    } else {
        request->send(400, "text/plain", "Invalid parameters");
    }
});


//function to control the motors
void controlSteppers(int stepsX, float speedX, int stepsY, float speedY, int stepsZ, float speedZ) {
    digitalWrite(enablePin, LOW);
    movementComplete=false;
  
    stepperX.setMaxSpeed(speedX);
    stepperY.setMaxSpeed(speedY);
    stepperZ.setMaxSpeed(speedZ);
  
    stepperX.move(stepsX);
    stepperY.move(stepsY);
    stepperZ.move(stepsZ);
  }

//then we put it into loop
void loop() {
    stepperX.run();
    stepperY.run();
    stepperZ.run();
}
                        </code></pre>
                    </div>
                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">

                    <div id="code-container">
                        <pre><code class="language-clike">
                            //Python CODE

//#Send a command to the ESP32 to control motor movements.

def send_command(stepsX, speedX, stepsY, speedY, stepsZ, speedZ):

url = f"http://{esp32_ip}/control"
params = {
    'stepsX': stepsX,
    'speedX': speedX,
    'stepsY': stepsY,
    'speedY': speedY,
    'stepsZ': stepsZ,
    'speedZ': speedZ
}
try:
    response = requests.get(url, params=params)
    print(response.text)
except requests.RequestException as e:
    print(f"Error sending request: {e}")


//#Sample command
v=1
stepsX = 1600  *3*0.2 
speedX = 500   *2*v

# B
stepsY = -1600  *6*0.2
speedY = 500   *4*v

# A
stepsZ = 1600  *3*0.2
speedZ = 500   *2*v
     
send_command(stepsX, speedX, stepsY, speedY, stepsZ, speedZ)
                            
                        </code></pre>
                    </div>

                </div>
            </div>


            <div class="row align-items-center">

                <div class="col-sm-12 col-md-12 col-lg-12">
                    <li style="text-align: left;">We can achieve both Polar and Cartesian, as we can control the speed
                        and steps for the wheels
                        independently for cartesian
                        we only send one command, and polar we send two commands one for rotation seperated so it will
                        exceute rotation then translation, and thats where the route <code>ESP_ip_Address/status</code>
                        comes in handy.
                    </li>
                </div>


            </div>

            <br>
            <div class="row align-items-center">

                <div class="col-sm-12 col-md-12 col-lg-12">
                    <h5>/status</h5>
                    <p>Essentially we have a global variable <code>movementComplete </code> set to False and we set it
                        to True once we finish the request, on python side we keep requesting <code>/status</code> till
                        it returns True, only then we send the following <code>send_command()</code> to motors </p>


                </div>


            </div>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">
                    <div id="code-container">
                        <pre><code class="language-js">
                      //ESP-32 CODE

//global variable
bool movementComplete = false;

//setting up the server route
server.on("/status", HTTP_GET, [](AsyncWebServerRequest *request){
    if (movementComplete) {
        request->send(200, "text/plain", "Movement complete");
        movementComplete = false; // Reset the flag
    } else {
        request->send(200, "text/plain", "Movement in progress");
    }
});


//make "movementComplete" true when the robot is done moving
if (stepperX.distanceToGo() == 0 && stepperY.distanceToGo() == 0 && stepperZ.distanceToGo() == 0) {
    if (!motorsStopped) {
      delay(500);
      digitalWrite(enablePin, HIGH);
      Serial.println("Motors stopped");
      motorsStopped = true;
      movementComplete = true;

}
                        </code></pre>
                    </div>
                </div>

                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-6">

                    <div id="code-container">
                        <pre><code class="language-clike">
                            //Python CODE

//#returns True if the motors stops
def check_movement_complete():
    while True:
        response = requests.get(f"http://{esp32_ip}/status")
        if response.text == "Movement complete":
            break
        time.sleep(0.5)  # Poll every half second    

def execute_follow_up_command(translation_steps, motor_speed):
    # Wait for the first command to complete
    check_movement_complete()
    # Execute the second command
    send_command(translation_steps, motor_speed, 0, motor_speed, -translation_steps, motor_speed)

//sample with polar coordinates
if ball_measurements is not None:
    for center, radius, distance, angle, X_coordinate, Y_coordinate in ball_measurements:
        print(f"Distance = {distance:.1f} cm, Angle = {angle:.1f} degrees")

    rotation_steps = -calculate_rotation_steps(angle)
    translation_steps = calculate_translation_steps(distance/100)-100
    print(f"Rotation Steps: {rotation_steps}, Translation Steps: {translation_steps}")

    //translation command
    send_command(rotation_steps, MOTOR_SPEED, rotation_steps, MOTOR_SPEED, rotation_steps, MOTOR_SPEED)
    //rotation command
    threading.Thread(target=lambda: execute_follow_up_command(translation_steps, MOTOR_SPEED)).start()


                            
                        </code></pre>
                    </div>

                </div>
            </div>

            <div class="row align-items-center">

                <div style="text-align: left;" class="col-sm-12 col-md-12 col-lg-12">
                    <li>So in this example, we first send the rotation command we wait till it finishes then we send
                        translation </li>
                    <li> Im using a time.delay in python to keep requesting from the server
                        periodically and
                        time.delay is a blocking function Im using that with <code>threading</code> so the program and
                        the UI won't
                        freeze</li>
                    <li>This also helpful in error mitigation as I devide big dsitances into samller steps then we
                        recalculate the dsitances to avoid error propogation</li>


                </div>


            </div>
            <br>

            <p>The other ones are more straight forward, for more info check my code on <a
                    href="https://github.com/rachad47/BilliardBot">GitHub</a> under firmware.</p>



            <br>

            <hr class="dotted">

            <h3>Graphical User Interface</h3>
            <br>
            <p>the main purpose of the GUI is for testing, I used <code>Tkinter</code> with the help of
                <code>CustomTkinter</code> fora modern UI
            </p>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: center;">Idea</h5>
                    <p>
                        I got the idea while doing ball detection with six adjustable parameters. To avoid repeatedly
                        running the program for each change, I built a UI, making the process much easier as I see the
                        changes in real time. </p>

                    <img src="images/project/BilliardBot/hough.png" alt=""
                        style="max-height:400px ; width: 100%;height: auto;" id="programmingLAn">

                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-6 col-lg-5">
                    <img src="images/project/BilliardBot/CircleH.png" alt=""
                        style="max-height:400px ; width: 100%;height: auto;" id="programmingLA">
                </div>
            </div>

            <div class="row align-items-center">
                <div style="text-align: left;" class="col-sm-12 col-md-6 col-lg-7">
                    <h5 style="text-align: center;">HSV-thresholds / autosave</h5>
                    <li>As explained in the Compter Vision section Im using color thresholds, the issue is as I change
                        the light condition some thresholds fails so having the option to change the thresholds and see
                        the counter in real time really helped (PUT GIF HERE) </li>
                    <li>As I click close it automatically saves thresholds into a .txt file and upon launching the
                        program again it reads and loads from that file</li>

                </div>
                <div style="text-align: right;" class="col-sm-12 col-md-6 col-lg-5">
                    <img src="images/project/BilliardBot/hsvT.png" alt=""
                        style="max-height:400px ; width: 100%;height: auto;" id="programmingLA">
                </div>
            </div>

            <br>
            <p>
                I added the robot's control section to perform basic movement commands and a firing sequence </p>
            <img src="images/project/BilliardBot/UI.png" alt="" style=" width: 100%;height: auto;" id="programmingLA">

            <br>

            <hr class="dotted">

            <h3>Integration test & future improvements </h3>
            <br>

            <img src="images/project/BilliardBot/Work_In_Progress.png" alt="" style="width: 40%;height: auto;"
                        id="programmingLA">

            <br>
            <br>
            <h4 style="text-align: left;">future improvements:</h4>
            <br>
            <div class="row align-items-center">
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/tenserflow.png" alt="" style="width: 100%;height: auto;"
                        id="programmingLA">
                </div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <h5>Ball detection & classification</h5>
                    <br>
                    <p>Training a ML model that accuratly detects then classify the balls into 4 categories (black ,
                        cue, solid and stripes) </p>
                </div>

            </div>


            <div class="row align-items-center">
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <h5>Smart game strategy</h5>
                    <br>
                    <p>Compute all posibilities and see which ball to hit the best to both increase a maximum a scores
                        in row (like after striking using phys we would want the ball to finish in a posistion that is
                        easy for the robot to score again) additionally we would want the ball to endup in a position to
                        make it harder for the opponent </p>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/AI-decisions.png" alt="" style="width: 100%;height: auto;"
                        id="programmingLA">
                </div>


            </div>

            <div class="row align-items-center">
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <img src="images/project/BilliardBot/ai.png" alt="" style="width: 100%;height: auto;"
                        id="programmingLA">
                </div>
                <div class="col-sm-12 col-md-6 col-lg-6">
                    <h5>Make autonomous</h5>
                    <br>
                    <p> Play the game with less human intervention, ie: know when is not its turn so its wait for the
                        other player to strike... </p>
                </div>

            </div>


            <br>



            <br>



            <!-- no touch  -->
        </div>
    </section>
    <hr class="rounded">



    <!-- work experienc ... -->


    <!-- Big PROJECTS 1 -->


    <!-- Big PROJECTS 2 -->


    <!-- other project -->

    <!-- asdgashdhasd -->


    <!-- CONTACT -->

    <!-- FOOTER -->

    <section class="contact py-5" id="contact">
        <div style="text-align: center;" class="container">
            <div class="row">
                <div class="col-12 col-sm-6 col-md col-lg">
                    <p> <i style=" color:#efc008e4;" class="fa-solid fa-envelope"></i>Rachadelmtq@gmail.com</li>
                    </p>
                </div>

                <div class="col-4 col-sm-1 col-md-1 col-lg-1">
                    <p> <a href="https://www.facebook.com/rachad.elmoutaouaffiq.3/"><i style=" color:#efc008e4;"
                                class="fa-brands fa-facebook"></i></a></p>
                </div>

                <div class="col-4 col-sm-1 col-md-1 col-lg-1">

                    <p> <a href="https://www.instagram.com/rachad.mtq/"><i style=" color:#efc008e4;"
                                class="fa-brands fa-instagram"></i></a></p>
                </div>

                <div class="col-4 col-sm-1 col-md-1 col-lg-1">
                    <p> <a href="https://www.linkedin.com/in/rachad-el-moutaouaffiq-94a2301b2/"><i
                                style=" color:#efc008e4;" class="fa-brands fa-linkedin"></i></a></p>
                </div>

                <div class="col-12 col-sm-6 col-md col-lg">
                    <p> <i style=" color:#efc008e4;" class="fa-solid fa-phone"></i>+1 (438) 878-0603</li>
                    </p>
                </div>
                <hr>
                <div class="col-lg-12 col-12">
                    <br>

                    <p class=" text-center">Rachad El Moutaouaffiq</p>

                </div>


                <!-- <a href="https://www.facebook.com/rachad.elmoutaouaffiq.3/"><i style=" color:#efc008e4;" class="fa-solid fa-phone"></i></a>
            <i style=" color:#efc008e4;" class="fa-brands fa-facebook"></i>
            <i style=" color:#efc008e4;" class="fa-brands fa-instagram"></i>
            <i style=" color:#efc008e4;" class="fa-brands fa-linkedin"></i> -->

                <!-- <img src="images/project/email.png" alt="Paris" style="height:300px; color:red;" id="programmingLA"> -->



                <!-- <div class="col-lg-12 col-12">
              <div class="contact-form">
                <h2 class="mb-4">Interested to work together? Let's talk</h2>
    
                <form action="" method="get">
                  <div class="row">
                    <div class="col-lg-3 col-12">
                      <input type="text" class="form-control" name="name" placeholder="Your Name" id="name">
                    </div>
    
                    <div class="col-lg-3 col-12">
                      <input type="email" class="form-control" name="email" placeholder="Email" id="email">
                    </div>
    
                    <div class="col-12">
                      <textarea name="message" rows="6" class="form-control" id="message" placeholder="Message"></textarea>
                    </div>
    
                    <div class="ml-lg-auto col-lg-2 col-12">
                      <input type="submit" class="form-control submit-btn" value="Send">
                    </div>
                  </div>
                </form>
              </div>
            </div> -->

            </div>
        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/Headroom.js"></script>
    <script src="js/jQuery.headroom.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/smoothscroll.js"></script>
    <script src="js/custom.js"></script>

    <script src="https://kit.fontawesome.com/21c51861f3.js" crossorigin="anonymous"></script>

</body>

</html>
